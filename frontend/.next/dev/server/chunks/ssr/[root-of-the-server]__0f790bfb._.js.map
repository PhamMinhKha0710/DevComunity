{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/DevComunity/frontend/src/app/questions/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport apiClient from '@/api/client';\r\nimport type { Question, Answer } from '@/types';\r\n\r\nexport default function QuestionDetailPage() {\r\n    const { id } = useParams();\r\n    const { user } = useAuth();\r\n    const [question, setQuestion] = useState<Question | null>(null);\r\n    const [answers, setAnswers] = useState<Answer[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [newAnswer, setNewAnswer] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchQuestion();\r\n    }, [id]);\r\n\r\n    const fetchQuestion = async () => {\r\n        try {\r\n            const [questionRes, answersRes] = await Promise.all([\r\n                apiClient.get<Question>(`/questions/${id}`),\r\n                apiClient.get<Answer[]>(`/questions/${id}/answers`),\r\n            ]);\r\n            setQuestion(questionRes.data);\r\n            setAnswers(answersRes.data || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch question:', error);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleVote = async (type: 'up' | 'down', targetType: 'question' | 'answer', targetId: number) => {\r\n        if (!user) return;\r\n        try {\r\n            await apiClient.post(`/votes`, {\r\n                targetType,\r\n                targetId,\r\n                isUpvote: type === 'up',\r\n            });\r\n            fetchQuestion();\r\n        } catch (error) {\r\n            console.error('Vote failed:', error);\r\n        }\r\n    };\r\n\r\n    const handleSubmitAnswer = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!newAnswer.trim() || !user) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            await apiClient.post(`/answers`, {\r\n                questionId: Number(id),\r\n                body: newAnswer,\r\n            });\r\n            setNewAnswer('');\r\n            fetchQuestion();\r\n        } catch (error) {\r\n            console.error('Failed to submit answer:', error);\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!question) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center\">\r\n                <div className=\"text-center\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900\">Question not found</h2>\r\n                    <Link href=\"/\" className=\"mt-4 inline-block text-orange-500 hover:text-orange-600\">\r\n                        ← Back to home\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50\">\r\n            <header className=\"bg-white shadow-sm border-b\">\r\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\r\n                    <Link href=\"/\" className=\"text-2xl font-bold text-orange-500\">\r\n                        DevComunity\r\n                    </Link>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n                {/* Question */}\r\n                <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\r\n                    <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">{question.title}</h1>\r\n\r\n                    <div className=\"flex gap-6\">\r\n                        {/* Voting */}\r\n                        <div className=\"flex flex-col items-center gap-2\">\r\n                            <button\r\n                                onClick={() => handleVote('up', 'question', question.questionId)}\r\n                                className={`p-2 rounded hover:bg-gray-100 ${question.userVoteType === 'up' ? 'text-orange-500' : 'text-gray-400'}`}\r\n                            >\r\n                                ▲\r\n                            </button>\r\n                            <span className=\"text-xl font-semibold\">{question.score}</span>\r\n                            <button\r\n                                onClick={() => handleVote('down', 'question', question.questionId)}\r\n                                className={`p-2 rounded hover:bg-gray-100 ${question.userVoteType === 'down' ? 'text-orange-500' : 'text-gray-400'}`}\r\n                            >\r\n                                ▼\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Content */}\r\n                        <div className=\"flex-1\">\r\n                            <div className=\"prose max-w-none\" dangerouslySetInnerHTML={{ __html: question.body }} />\r\n\r\n                            <div className=\"mt-6 flex gap-2 flex-wrap\">\r\n                                {question.tags?.map((tag) => (\r\n                                    <span key={tag.tagId} className=\"bg-blue-50 text-blue-600 px-2 py-1 rounded text-sm\">\r\n                                        {tag.tagName}\r\n                                    </span>\r\n                                ))}\r\n                            </div>\r\n\r\n                            <div className=\"mt-4 text-sm text-gray-500\">\r\n                                asked by <span className=\"text-blue-600\">{question.authorUsername}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Answers */}\r\n                <div className=\"mb-6\">\r\n                    <h2 className=\"text-xl font-bold text-gray-900 mb-4\">{answers.length} Answers</h2>\r\n\r\n                    {answers.map((answer) => (\r\n                        <div key={answer.answerId} className={`bg-white rounded-lg shadow p-6 mb-4 ${answer.isAccepted ? 'border-l-4 border-green-500' : ''}`}>\r\n                            <div className=\"flex gap-6\">\r\n                                <div className=\"flex flex-col items-center gap-2\">\r\n                                    <button\r\n                                        onClick={() => handleVote('up', 'answer', answer.answerId)}\r\n                                        className={`p-2 rounded hover:bg-gray-100 ${answer.userVoteType === 'up' ? 'text-orange-500' : 'text-gray-400'}`}\r\n                                    >\r\n                                        ▲\r\n                                    </button>\r\n                                    <span className=\"text-xl font-semibold\">{answer.score}</span>\r\n                                    <button\r\n                                        onClick={() => handleVote('down', 'answer', answer.answerId)}\r\n                                        className={`p-2 rounded hover:bg-gray-100 ${answer.userVoteType === 'down' ? 'text-orange-500' : 'text-gray-400'}`}\r\n                                    >\r\n                                        ▼\r\n                                    </button>\r\n                                    {answer.isAccepted && (\r\n                                        <span className=\"text-green-500 text-2xl\">✓</span>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"flex-1\">\r\n                                    <div className=\"prose max-w-none\" dangerouslySetInnerHTML={{ __html: answer.body }} />\r\n                                    <div className=\"mt-4 text-sm text-gray-500\">\r\n                                        answered by <span className=\"text-blue-600\">{answer.authorUsername}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Add Answer Form */}\r\n                {user ? (\r\n                    <div className=\"bg-white rounded-lg shadow p-6\">\r\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Your Answer</h3>\r\n                        <form onSubmit={handleSubmitAnswer}>\r\n                            <textarea\r\n                                value={newAnswer}\r\n                                onChange={(e) => setNewAnswer(e.target.value)}\r\n                                rows={8}\r\n                                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500\"\r\n                                placeholder=\"Write your answer here...\"\r\n                                required\r\n                            />\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={isSubmitting}\r\n                                className=\"mt-4 bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 transition\"\r\n                            >\r\n                                {isSubmitting ? 'Posting...' : 'Post Your Answer'}\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"bg-white rounded-lg shadow p-6 text-center\">\r\n                        <p className=\"text-gray-600\">\r\n                            <Link href=\"/login\" className=\"text-orange-500 hover:text-orange-600\">Log in</Link> to post an answer\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}